<UserControl x:Class="HeBianGu.Applications.ControlBase.LinkWindow.TreeListControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:h="https://github.com/HeBianGu"
             xmlns:local="clr-namespace:HeBianGu.Applications.ControlBase.LinkWindow"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             d:DesignHeight="450"
             d:DesignWidth="800"
             FontSize="{DynamicResource {x:Static h:FontSizeKeys.Default}}"
             Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundDefault}}"
             mc:Ignorable="d">
    <Grid Grid.Row="1" Grid.Column="1" Margin="15,0,15,20">

        <Grid.RowDefinitions>
            <RowDefinition Height="50" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="50" />
            <RowDefinition />
            <RowDefinition Height="50" />
        </Grid.RowDefinitions>

        <Button Grid.Row="0"
                   HorizontalAlignment="Left"
                   Command="{Binding RelayCommand}"
                   CommandParameter="TreeList.Load"
                   Content="加载..."
                   Style="{DynamicResource {x:Static h:ButtonKeys.Dynamic}}" />

        <Grid Grid.Row="4">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="100" />
                <ColumnDefinition Width="100" />
                <ColumnDefinition Width="100" />
                <ColumnDefinition />
            </Grid.ColumnDefinitions>

            <TextBlock HorizontalAlignment="Left"
                       VerticalAlignment="Center"
                       Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundTitle}}"
                       Text="数量总计：" />

            <TextBlock Grid.Column="1"
                       Margin="10,5"
                       HorizontalAlignment="Left"
                       VerticalAlignment="Center"
                       FontWeight="Bold"
                       Foreground="{DynamicResource {x:Static h:BrushKeys.Red}}"
                       Text="{Binding Count}" />

            <TextBlock Grid.Column="2"
                       Margin="10,5"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"
                       Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundTitle}}"
                       Text="选则项目：" />

            <TextBlock Grid.Column="3"
                       Margin="10,5"
                       HorizontalAlignment="Left"
                       VerticalAlignment="Center"
                       Foreground="{DynamicResource {x:Static h:BrushKeys.Orange}}">
                <Run Text="{Binding ElementName=treeList, Path=SelectedItem.Code}" />
                <Run Text="-" />
                <Run Text="{Binding ElementName=treeList, Path=SelectedItem.Name}" />
            </TextBlock>
        </Grid>

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="100" />
                <ColumnDefinition />
            </Grid.ColumnDefinitions>

            <TextBlock HorizontalAlignment="Left"
                       VerticalAlignment="Top"
                       Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundTitle}}"
                       Text="选择类别：" />

            <ListBox Grid.Column="1"
                     MinHeight="50"
                     VerticalAlignment="Center"
                     ItemsSource="{Binding EntityCheck}"
                     SelectedIndex="0"
                     SelectedItem="{Binding SelectEntityNode}"
                     Style="{DynamicResource {x:Static h:ListBoxKeys.CheckBoxWrapPanel}}" />
        </Grid>

        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="100" />
                <ColumnDefinition />
            </Grid.ColumnDefinitions>

            <TextBlock HorizontalAlignment="Left"
                       VerticalAlignment="Center"
                       Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundTitle}}"
                       Text="输入条件：" />

            <TextBox Grid.Column="1"
                        Width="Auto"
                        Height="30"
                        Style="{DynamicResource {x:Static h:TextBoxKeys.Clear}}"
                        TextChanged="Txt_filter_TextChanged" />
        </Grid>


        <h:TreeListView x:Name="treeList"
                        Grid.Row="3"
                        FontSize="{DynamicResource {x:Static h:FontSizeKeys.Default}}"
                        ItemsSource="{Binding Nodes}"
                        SelectItem="{Binding SelectTreeEntityNode, Mode=TwoWay}">
            <h:TreeListView.ItemTemplate>
                <HierarchicalDataTemplate ItemsSource="{Binding Nodes}" />
            </h:TreeListView.ItemTemplate>
            <h:TreeListView.Columns>
                <GridViewColumnCollection>
                    <GridViewColumn Width="500" Header="列头">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <DockPanel>
                                    <ToggleButton x:Name="Expander"
                                                  Margin="{Binding Path=Level, Converter={StaticResource LevelIndentConverter}, RelativeSource={RelativeSource AncestorType={x:Type h:TreeListViewItem}}}"
                                                  ClickMode="Press"
                                                  IsChecked="{Binding Path=IsExpanded, RelativeSource={RelativeSource AncestorType={x:Type h:TreeListViewItem}}}"
                                                  Style="{StaticResource {x:Static h:ToggleButtonKeys.Tree}}" />
                   
                                    <TextBlock Margin="5,0">
                                        <Run Text="{Binding Code}" />
                                        <Run Text="{Binding Name}" />
                                    </TextBlock>
                                </DockPanel>
                                <DataTemplate.Triggers>
                                    <DataTrigger Binding="{Binding Path=HasItems, RelativeSource={RelativeSource AncestorType={x:Type h:TreeListViewItem}}}" Value="False">
                                        <Setter TargetName="Expander" Property="Visibility" Value="Hidden" />
                                    </DataTrigger>
                                </DataTemplate.Triggers>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Width="200" DisplayMemberBinding="{Binding Name}" Header="名称" />
                    <GridViewColumn Width="200" DisplayMemberBinding="{Binding Code}" Header="编号" />
                    <GridViewColumn Width="200" DisplayMemberBinding="{Binding RootCode}" Header="类型" />
                    <GridViewColumn Width="200" DisplayMemberBinding="{Binding ParentID}" Header="父节点" />
                </GridViewColumnCollection>
            </h:TreeListView.Columns>
        </h:TreeListView>
    </Grid>
</UserControl>
